<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>hwlib: hwlib::i2c_bus Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="hwlib_icon.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">hwlib
   </div>
   <div id="projectbrief">C++ OO-style close-to-the-hardware library</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classhwlib_1_1i2c__bus.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classhwlib_1_1i2c__bus-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">hwlib::i2c_bus Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>i2c bus master interface  
 <a href="classhwlib_1_1i2c__bus.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="hwlib-i2c_8hpp_source.html">hwlib-i2c.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for hwlib::i2c_bus:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classhwlib_1_1i2c__bus.png" usemap="#hwlib::i2c_5Fbus_map" alt=""/>
  <map id="hwlib::i2c_5Fbus_map" name="hwlib::i2c_5Fbus_map">
<area href="classhwlib_1_1i2c__bus__bit__banged__scl__sda.html" title="bit-banged i2c bus implementation" alt="hwlib::i2c_bus_bit_banged_scl_sda" shape="rect" coords="0,56,210,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae14982fedbb8dd79894a0fa1a408d58e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhwlib_1_1i2c__bus.html#ae14982fedbb8dd79894a0fa1a408d58e">write</a> (uint_fast8_t a, const uint8_t data[], size_t n)=0</td></tr>
<tr class="memdesc:ae14982fedbb8dd79894a0fa1a408d58e"><td class="mdescLeft">&#160;</td><td class="mdescRight">i2c write transaction  <a href="#ae14982fedbb8dd79894a0fa1a408d58e">More...</a><br /></td></tr>
<tr class="separator:ae14982fedbb8dd79894a0fa1a408d58e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c615e399e60072730040bb8f82f4bed"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhwlib_1_1i2c__bus.html#a3c615e399e60072730040bb8f82f4bed">read</a> (uint_fast8_t a, uint8_t data[], size_t n)=0</td></tr>
<tr class="memdesc:a3c615e399e60072730040bb8f82f4bed"><td class="mdescLeft">&#160;</td><td class="mdescRight">i2c read transaction  <a href="#a3c615e399e60072730040bb8f82f4bed">More...</a><br /></td></tr>
<tr class="separator:a3c615e399e60072730040bb8f82f4bed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>i2c bus master interface </p>
<p>This class abstracts the interface of a master to an I2C bus.</p>
<p>In its simplest form, an I2C bus has one master and a number of slaves that are connected by two wires: SCL (clock) and SDA (data). Both lines are pulled up by pull-up resistor, and can (only) be pulled down by a connected chip (open-collector).</p>
<div class="image">
<img src="i2c-bus.png" alt="i2c-bus.png"/>
</div>
<p>An I2C transaction is either a read transaction or a transaction. In both cases, the transaction starts with the master transmitting a control byte, which contains the address of the slave chip, and one bit that indicates whether it is a read or a write transaction. The bits of a byte are transferred MSB (most significant bit) first.</p>
<div class="image">
<img src="i2c-command-1.png" alt="i2c-command-1.png"/>
</div>
<div class="image">
<img src="i2c-command-2.png" alt="i2c-command-2.png"/>
</div>
<p>Next the slave chip receives (write transaction) or transmits (read transaction) as many bytes as the master asks for.</p>
<div class="image">
<img src="i2c-write-read.png" alt="i2c-write-read.png"/>
</div>
<p>At the bit level, master generates clock pulses by pulling the SCL line low. While the SCL is low, the master or slave can put a bit on the SDA line by pulling it down (for a 0) or letting it float (for a 1). The SCL line is always driven by the master (unless the slave uses clock-stretching), the SDA line is driven by the device on the bus that sends the bit.</p>
<div class="image">
<img src="i2c-bit-level.png" alt="i2c-bit-level.png"/>
</div>
<p>Two special conditions are used. To signal the start (S) of a transaction, the sda is pulled low while the clk is high. The reverse is used to indicate a stop (P, the end of a transaction): the dta is released (goes high) while the clock is high.</p>
<div class="image">
<img src="i2c-signaling.png" alt="i2c-signaling.png"/>
</div>
<p>Most slave chips that have only one data byte that can be read or written use a single-byte read or write transmission to read or write that data byte. Slave chips that have more than one address that can be written often use a write transaction where the first byte(s) written determine the address (within the slave chip), and the subsequent byte(s) are written to that address (and to the next addresses). An I2C read transaction addresses the slave chip, but has no provision to specify an address within the slave chip. A common trick is that a read addresses the last address specified by a (previous) write transaction. Hence to read from address X first a write is done to address X, but the transaaction stops after the X, hence nothing is written, but this sets the address pointer inside the slave chip. Now a read transaction reads from this address.</p>
<p>As always, consult the datasheet of the chip for the details.</p>
<p>The I2C bus was invented by Philips, who had a patent on it. Hence other manufacturers that implemented the I2C bus on their chips had either to pay royalties to Philips, or tried to avoid this by implementing a protocol that was compatible with I2C, without mentioning I2C. The I2C patent has expired, but you can still find many chips that are described as 'implementing a two-wire protocol' or something similar. In most cases this means that the chip implements I2C.</p>
<p>references:</p><ul>
<li><a href="http://www.nxp.com/documents/user_manual/UM10204.pdf">I2C bus specification and user manual</a> (pdf)</li>
<li><a href="http://i2c.info/i2c-bus-specification">I2C Bus Specification</a> (info page)</li>
<li><a href="https://en.wikipedia.org/wiki/I2C">I2C Bus</a> (wikipedia) </li>
</ul>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a3c615e399e60072730040bb8f82f4bed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c615e399e60072730040bb8f82f4bed">&#9670;&nbsp;</a></span>read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void hwlib::i2c_bus::read </td>
          <td>(</td>
          <td class="paramtype">uint_fast8_t&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>data</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>i2c read transaction </p>
<p>This function reads n bytes from the slave at address a to data[].</p>
<p>Note that n is a byte, hence the maximum number of bytes is 255. </p>

<p>Implemented in <a class="el" href="classhwlib_1_1i2c__bus__bit__banged__scl__sda.html#ac6147d2a6a9d56d3c4da05d99552728f">hwlib::i2c_bus_bit_banged_scl_sda</a>.</p>

</div>
</div>
<a id="ae14982fedbb8dd79894a0fa1a408d58e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae14982fedbb8dd79894a0fa1a408d58e">&#9670;&nbsp;</a></span>write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void hwlib::i2c_bus::write </td>
          <td>(</td>
          <td class="paramtype">uint_fast8_t&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>data</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>i2c write transaction </p>
<p>This function write n bytes from data[] to the slave at address a.</p>
<p>Note that n is a byte, hence the maximum number of bytes is 255. </p>

<p>Implemented in <a class="el" href="classhwlib_1_1i2c__bus__bit__banged__scl__sda.html#a6102290be7dfe07fb0743820889e9a68">hwlib::i2c_bus_bit_banged_scl_sda</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="hwlib-i2c_8hpp_source.html">hwlib-i2c.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacehwlib.html">hwlib</a></li><li class="navelem"><a class="el" href="classhwlib_1_1i2c__bus.html">i2c_bus</a></li>
    <li class="footer">Generated on Mon Feb 11 2019 09:25:51 for hwlib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
